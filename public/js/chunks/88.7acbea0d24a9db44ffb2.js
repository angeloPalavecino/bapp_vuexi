(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{GVgF:function(e,a,t){"use strict";t.r(a);var s=t("Snq/"),i=t.n(s),r=t("bJaO"),l=t("e7F3"),o=t("LuQd"),n=(t("2pMc"),t("w48C")),c=t.n(n);t("CVKz");l.a.localize("en",{custom:{horario:{required:"El horario es requerido"},tipo:{required:"El tipo es requerido"},tipo_fecha:{required:"El periodo es requerido"},meses:{required:"Debe seleccionar al menos un mes"},ano:{required:"Debe seleccionar el año"},periodos_fecha_dias:{required:"Debe seleccionar al menos un dia"},codificaciones_cantidad:{required:"Debe seleccionar al menos un codificado",min_value:"Debe seleccionar al menos un codificado"}}});var d={components:{vSelect:i.a,FormWizard:o.FormWizard,TabContent:o.TabContent,flatPickr:c.a},data:function(){return{urlApi:"/agendamientos/agendamientos/",data_local:{meses:[]},empresa:1,sucursal:null,tipo_fecha:0,empresasOptions:[],sucursalesOptions:[],horariosOptions:[],tipoOptions:[{label:"Zarpe",value:"Zarpe"},{label:"Recogida",value:"Recogida"}],tipofechaOptions:[{label:"Diario",value:1},{label:"Mensual",value:2},{label:"Permanente",value:3}],anosOptions:[{label:"2020",value:2020},{label:"2021",value:2021},{label:"2022",value:2022},{label:"2023",value:2023},{label:"2024",value:2024},{label:"2025",value:2025},{label:"2026",value:2026},{label:"2027",value:2027},{label:"2028",value:2028},{label:"2029",value:2029},{label:"2030",value:2030},{label:"2031",value:2031},{label:"2032",value:2032},{label:"2033",value:2033},{label:"2034",value:2034},{label:"2035",value:2035},{label:"2036",value:2036},{label:"2037",value:2037}],mesesOptions:[{label:"Enero",value:1},{label:"Febrero",value:2},{label:"Marzo",value:3},{label:"Abril",value:4},{label:"Mayo",value:5},{label:"Junio",value:6},{label:"Julio",value:7},{label:"Agosto",value:8},{label:"Septiembre",value:9},{label:"Octubre",value:10},{label:"Noviembre",value:11},{label:"Diciembre",value:12}],configDiasdateTimePicker:{minDate:new Date,maxDate:"2037-12-31",dateFormat:"Y/m/d",mode:"multiple"},codificacionesOptions:[],cantidadCodificaciones:null,selected:[]}},watch:{empresa:function(e){this.sucursal=null,this.data_local.horario=null,this.sucursalesOptions=[],this.horariosOptions=[],this.traeSucursales(e)},sucursal:function(e){this.data_local.horario=null,this.horariosOptions=[],this.codificacionesOptions=[],this.cantidadCodificaciones=null,this.selected=[],this.traeHorarios(e),this.traecodificaciones(e)}},computed:{validateForm:function(){return!this.errors.any()}},mounted:function(){this.traeOtrosDatos()},methods:{handleSelected:function(){this.cantidadCodificaciones=this.selected.length},traeOtrosDatos:function(){var e=this;r.a.get("/api/v1/empresas/listemp").then((function(a){e.empresasOptions=a.data.items})).catch((function(a){var t=300==a.response.status?a.response.data.message:a;e.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},traecodificaciones:function(e){var a=this;e>0?r.a.get("/api/v1/codificaciones/combo/"+e).then((function(e){a.codificacionesOptions=e.data.items})).catch((function(e){var t=300==e.response.status?e.response.data.message:e;a.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):this.codificacionesOptions=[]},traeSucursales:function(e){var a=this;e>1?r.a.get("/api/v1/sucursal/combo/"+e).then((function(e){a.sucursalesOptions=e.data.items})).catch((function(e){var t=300==e.response.status?e.response.data.message:e;a.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):this.sucursalesOptions=[]},traeHorarios:function(e){var a=this;e>0?r.a.get("/api/v1/horarios/combo/"+e).then((function(e){a.horariosOptions=e.data.items})).catch((function(e){var t=300==e.response.status?e.response.data.message:e;a.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):this.horariosOptions=[]},limpiarFechas:function(){this.data_local.fechas=null,this.data_local.meses=[],this.data_local.ano=null},validateStep1:function(){var e=this;return new Promise((function(a,t){e.$validator.validateAll("step-1").then((function(e){e?a(!0):t("correct all values")}))}))},validateStep2:function(){var e=this;return new Promise((function(a,t){e.$validator.validateAll("step-2").then((function(s){s?(e.save_changes(),a(!0)):t("correct all values")}))}))},save_changes:function(){var e=this;this.$validator.validateAll().then((function(a){a&&(e.datos=[],e.datos.push(e.data_local),e.datos.push(e.selected),e.$store.dispatch("itemManagement/agregarItem",{item:e.datos,Url:e.urlApi}).then((function(){e.$router.push({name:"agendamientos"}),e.showDeleteSuccess()})).catch((function(a){var t=300==a.response.status?a.response.data.message:a;e.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})))}))},showDeleteSuccess:function(){this.$vs.notify({color:"success",title:"Guardar registros",text:"Los registros se han guardado exitosamente."})},reset_data:function(){this.data_local={meses:[]},this.codificaciones=[],this.codificacionesOptions=[],this.cantidadCodificaciones=null,this.$refs.wizard.reset(),this.errors.clear()}}},u=t("KHd+"),v=Object(u.a)(d,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"item-add"}},[t("div",{staticClass:"mt-6 mb-5"},[t("form-wizard",{ref:"wizard",staticClass:"mt-6 ",attrs:{color:"rgba(var(--vs-primary), 1)",errorColor:"rgba(var(--vs-danger), 1)",title:"AGREGAR AGENDAMIENTO",subtitle:"Ingrese todos los campos para ingresar el agendamiento",finishButtonText:"Agregar"},scopedSlots:e._u([{key:"footer",fn:function(a){return[t("div",{staticClass:"wizard-footer-left"},[a.activeTabIndex>0?t("vs-button",{style:a.fillButtonStyle,nativeOn:{click:function(e){return a.prevTab()}}},[e._v("Anterior")]):e._e()],1),e._v(" "),t("div",{staticClass:"wizard-footer-right"},[a.isLastStep?t("vs-button",{staticClass:"wizard-footer-right finish-button",style:a.fillButtonStyle,nativeOn:{click:function(e){return a.nextTab()}}},[e._v("\n          Agregar")]):t("vs-button",{staticClass:"wizard-footer-right",style:a.fillButtonStyle,nativeOn:{click:function(e){return a.nextTab()}}},[e._v("Siguiente")])],1)]}}])},[t("tab-content",{staticClass:"mb-1 ",attrs:{title:"Paso 1",icon:"feather icon-clock","before-change":e.validateStep1}},[t("form",{attrs:{"data-vv-scope":"step-1"}},[t("div",[t("vs-divider",{attrs:{color:"primary"}},[t("h5",[e._v("Datos Agendamiento")])])],1),e._v(" "),t("div",{staticClass:"vx-row"},[t("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[t("vs-select",{ref:"empresas",staticClass:"w-full p-1",attrs:{label:"Empresas",name:"empresa",dir:e.$vs.rtl?"rtl":"ltr"},model:{value:e.empresa,callback:function(a){e.empresa=a},expression:"empresa"}},e._l(e.empresasOptions,(function(e){return t("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.razon_social}})})),1)],1),e._v(" "),t("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[t("vs-select",{ref:"sucursal",staticClass:"w-full p-1",attrs:{label:"Sucursales",name:"sucursal",dir:e.$vs.rtl?"rtl":"ltr"},model:{value:e.sucursal,callback:function(a){e.sucursal=a},expression:"sucursal"}},e._l(e.sucursalesOptions,(function(e){return t("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.nombre}})})),1)],1),e._v(" "),t("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[t("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"horario",staticClass:"w-full p-1",attrs:{label:"Horarios",name:"horario",dir:e.$vs.rtl?"rtl":"ltr",disabled:!(e.sucursal>0),danger:!!e.errors.first("step-1.horario"),"danger-text":e.errors.first("step-1.horario")?e.errors.first("step-1.horario"):""},model:{value:e.data_local.horario,callback:function(a){e.$set(e.data_local,"horario",a)},expression:"data_local.horario"}},e._l(e.horariosOptions,(function(e){return t("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.label}})})),1)],1),e._v(" "),t("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[t("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"tipo",staticClass:"w-full p-1",attrs:{label:"Tipo",name:"tipo",dir:e.$vs.rtl?"rtl":"ltr",danger:!!e.errors.first("step-1.tipo"),"danger-text":e.errors.first("step-1.tipo")?e.errors.first("step-1.tipo"):""},model:{value:e.data_local.tipo,callback:function(a){e.$set(e.data_local,"tipo",a)},expression:"data_local.tipo"}},e._l(e.tipoOptions,(function(e){return t("vs-select-item",{key:e.value,attrs:{value:e.value,text:e.label}})})),1)],1),e._v(" "),t("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[t("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"tipo_fecha",staticClass:"w-full p-1",attrs:{label:"Periodo",name:"tipo_fecha",dir:e.$vs.rtl?"rtl":"ltr",danger:!!e.errors.first("step-1.tipo_fecha"),"danger-text":e.errors.first("step-1.tipo_fecha")?e.errors.first("step-1.tipo_fecha"):""},on:{input:e.limpiarFechas},model:{value:e.data_local.tipo_fecha,callback:function(a){e.$set(e.data_local,"tipo_fecha",a)},expression:"data_local.tipo_fecha"}},e._l(e.tipofechaOptions,(function(e){return t("vs-select-item",{key:e.value,attrs:{value:e.value,text:e.label}})})),1)],1),e._v(" "),1===e.data_local.tipo_fecha?t("div",{staticClass:"vx-col md:w-1/2 w-full mt-3"},[t("span",{staticClass:"text-sm"},[e._v("Fechas")]),e._v(" "),t("flat-pickr",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{config:e.configDiasdateTimePicker,placeholder:"Seleccione los dias",name:"periodos_fecha_dias"},model:{value:e.data_local.fechas,callback:function(a){e.$set(e.data_local,"fechas",a)},expression:"data_local.fechas"}}),e._v(" "),t("span",{staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("step-1.periodos_fecha_dias")))])],1):e._e(),e._v(" "),2===e.data_local.tipo_fecha?t("div",{staticClass:"vx-col md:w-1/4 w-full mt-2"},[t("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"ano",staticClass:"w-full p-1",attrs:{label:"Año",name:"ano",dir:e.$vs.rtl?"rtl":"ltr",danger:!!e.errors.first("step-1.ano"),"danger-text":e.errors.first("step-1.ano")?e.errors.first("step-1.ano"):""},model:{value:e.data_local.ano,callback:function(a){e.$set(e.data_local,"ano",a)},expression:"data_local.ano"}},e._l(e.anosOptions,(function(e){return t("vs-select-item",{key:e.value,attrs:{value:e.value,text:e.label}})})),1)],1):e._e(),e._v(" "),2===e.data_local.tipo_fecha?t("div",{staticClass:"vx-col md:w-1/4 w-full mt-2"},[t("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"meses",staticClass:"w-full p-1",attrs:{autocomplete:"",multiple:"",label:"Meses",name:"meses",dir:e.$vs.rtl?"rtl":"ltr",danger:!!e.errors.first("step-1.meses"),"danger-text":e.errors.first("step-1.meses")?e.errors.first("step-1.meses"):""},model:{value:e.data_local.meses,callback:function(a){e.$set(e.data_local,"meses",a)},expression:"data_local.meses"}},e._l(e.mesesOptions,(function(e){return t("vs-select-item",{key:e.value,attrs:{value:e.value,text:e.label}})})),1)],1):e._e()])])]),e._v(" "),t("tab-content",{staticClass:"mb-5",attrs:{title:"Paso 2",icon:"feather icon-list","before-change":e.validateStep2}},[t("form",{attrs:{"data-vv-scope":"step-2"}},[t("div",[t("vs-divider",{attrs:{color:"primary"}},[t("h5",[e._v("Codificaciones")])])],1),e._v(" "),t("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required|min_value:1",expression:"'required|min_value:1'"}],attrs:{type:"hidden",name:"codificaciones_cantidad"},model:{value:e.cantidadCodificaciones,callback:function(a){e.cantidadCodificaciones=a},expression:"cantidadCodificaciones"}}),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("step-2.codificaciones_cantidad"),expression:"errors.has('step-2.codificaciones_cantidad')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("step-2.codificaciones_cantidad")))]),e._v(" "),t("div",{staticClass:"vx-col w-full mt-3"},[t("vs-table",{attrs:{multiple:"",data:e.codificacionesOptions},on:{selected:e.handleSelected},scopedSlots:e._u([{key:"default",fn:function(a){var s=a.data;return e._l(s,(function(a,i){return t("vs-tr",{key:i,attrs:{data:a}},[t("vs-td",{attrs:{data:s[i].rut}},[e._v("\n                    "+e._s(s[i].rut)+"\n                  ")]),e._v(" "),t("vs-td",{attrs:{data:s[i].nombre}},[e._v("\n                    "+e._s(s[i].nombre)+" "+e._s(s[i].apellido)+"\n                  ")]),e._v(" "),t("vs-td",{attrs:{data:s[i].direccion}},[e._v("\n                    "+e._s(s[i].direccion)+"\n                  ")]),e._v(" "),t("vs-td",{attrs:{data:s[i].comuna}},[e._v("\n                    "+e._s(s[i].comuna)+"\n                  ")])],1)}))}}]),model:{value:e.selected,callback:function(a){e.selected=a},expression:"selected"}},[t("template",{slot:"header"},[t("h3",[e._v("\n                  Codificaciones\n                ")]),e._v(" "),t("br")]),e._v(" "),t("template",{slot:"thead"},[t("vs-th",[e._v("\n                  Rut\n                ")]),e._v(" "),t("vs-th",[e._v("\n                  Nombre\n                ")]),e._v(" "),t("vs-th",[e._v("\n                  Direccion\n                ")]),e._v(" "),t("vs-th",[e._v("\n                  Comuna\n                ")])],1)],2)],1)],1)])],1)],1),e._v(" "),t("div",{staticClass:"vx-row"},[t("div",{staticClass:"vx-col w-full"},[t("div",{staticClass:"mt-8 flex flex-wrap items-center justify-end"},[t("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[t("vs-button",{staticClass:"ml-4 mt-2",attrs:{"icon-pack":"feather",icon:"icon-arrow-left",to:{name:"agendamientos"}}},[e._v("Volver")])],1),e._v(" "),t("vx-tooltip",{attrs:{color:"primary",text:"Limpiar"}},[t("vs-button",{staticClass:"ml-4 mt-2",attrs:{type:"border",color:"warning"},on:{click:e.reset_data}},[e._v("Limpiar")])],1)],1)])])])}),[],!1,null,null,null).exports,p=t("6wlp"),f={components:{itemAddSection1:v},data:function(){return{urlApi:"/agendamientos/agendamientos/"}},created:function(){p.a.isRegistered||(this.$store.registerModule("itemManagement",p.a),p.a.isRegistered=!0)}},m=Object(u.a)(f,(function(){var e=this.$createElement,a=this._self._c||e;return a("div",{attrs:{id:"page-item-add"}},[a("vx-card",[a("item-add-section1",{staticClass:"mt-4"})],1)],1)}),[],!1,null,null,null);a.default=m.exports}}]);