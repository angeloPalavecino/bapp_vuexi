(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"6wlp":function(t,e,i){"use strict";var s=i("bJaO");function r(t){if(null==t)throw new TypeError("Cannot destructure undefined")}var a={agregarItem:function(t,e){return r(t),new Promise((function(t,i){s.a.post("/api/v1"+e.Url+"store",e.item).then((function(e){t(e)})).catch((function(t){i(t)}))}))},editarItem:function(t,e){return r(t),new Promise((function(t,i){var r="";r=e.item.id?e.Url+e.item.id:e.Url,s.a.put("/api/v1"+r,e.item).then((function(e){t(e)})).catch((function(t){i(t)}))}))},traerItems:function(t,e){var i=t.commit;return new Promise((function(t,r){s.a.get("/api/v1"+e).then((function(e){i("SET_ITEMS",e.data.items),t(e)})).catch((function(t){r(t)}))}))},traerItem:function(t,e){return r(t),new Promise((function(t,i){s.a.get("/api/v1"+e.Url+"".concat(e.Id)).then((function(e){t(e)})).catch((function(t){i(t)}))}))},borrarItem:function(t,e){var i=t.commit;return new Promise((function(t,r){s.a.delete("/api/v1"+e.Url+"".concat(e.Id)).then((function(s){i("REMOVE_RECORD",e.Id),t(s)})).catch((function(t){r(t)}))}))},borrarMasivoItem:function(t,e){var i=t.commit;return new Promise((function(t,r){s.a.post("/api/v1"+e.Url+"borrar",e.Items).then((function(s){i("REMOVE_MASSIVE_RECORD",e.Items),t(s)})).catch((function(t){r(t)}))}))}};e.a={isRegistered:!1,namespaced:!0,state:{items:[]},mutations:{SET_ITEMS:function(t,e){t.items=e},REMOVE_RECORD:function(t,e){var i=t.items.findIndex((function(t){return t.id==e}));t.items.splice(i,1)},REMOVE_MASSIVE_RECORD:function(t,e){e.forEach((function(e){var i=t.items.findIndex((function(t){return t.id==e.id}));t.items.splice(i,1)}))}},actions:a,getters:{}}},LJSe:function(t,e,i){"use strict";i.r(e);var s=i("Snq/"),r=i.n(s),a=i("bJaO"),o=i("6wlp");i("e7F3").a.localize("en",{custom:{moviles:{required:"Los moviles son requeridos"}}});var n={components:{vSelect:r.a},data:function(){return{urlApi:"/matriz/matriz/",sucursalFilter:{label:"Sin sucursal",value:"all",id:0},sucursalOptions:[],empresaFilter:{label:"Sin empresa",value:"all",id:0},empresaOptions:[],movilesOptions:[],gpatrones:[],horarios:[],matriz:[],popupActivo:!1,item:{horario_text:null,horario_id:null,grupopatrones_id:null,grupopatrones_text:null,sucursal_id:null,moviles:[]}}},watch:{sucursalFilter:function(t){this.gpatrones=[],this.horarios=[],this.matriz=[],this.traeMatriz(t.id)},empresaFilter:function(t){this.gpatrones=[],this.horarios=[],this.matriz=[],this.traeSucursales(t.id),this.traeMoviles(t.id)}},computed:{itemsData:function(){return this.$store.state.itemManagement.items},validateForm:function(){return!this.errors.any()}},methods:{popupClose:function(){this.item={horario_text:null,horario_id:null,grupopatrones_id:null,grupopatrones_text:null,moviles:[]},this.errors.clear(),this.popupActivo=!1},selectedCell:function(t,e,i){this.item.horario_id=t.id,this.item.horario_text=t.horario,this.item.grupopatrones_id=e.id,this.item.grupopatrones_text=e.codigo,this.item.sucursal_id=this.sucursalFilter.id,i.length>0&&(this.item.moviles=i.map((function(t,e){return t.car_id}))),this.errors.clear(),this.popupActivo=!0},getStatusColor:function(t){return t>0?"success":"danger"},resetColFilters:function(){this.sucursalFilter={label:"Sin sucursal",value:"all",id:0},this.empresaFilter={label:"Sin empresa",value:"all",id:0},this.$refs.filterCard.removeRefreshAnimation()},addRecord:function(){this.$router.push("../item-add/").catch((function(){}))},traeSucursales:function(t){var e=this;t>1?a.a.get("/api/v1/sucursal/combo/"+t).then((function(t){e.sucursalOptions=t.data.items})).catch((function(t){var i=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):(this.sucursalFilter={label:"Sin sucursal",value:"all",id:0},this.sucursalOptions=[])},traeMoviles:function(t){var e=this;t>1?a.a.get("/api/v1/car/matriz/"+t).then((function(t){e.movilesOptions=t.data.items})).catch((function(t){var i=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):this.movilesOptions=[]},traeMatriz:function(t){var e=this;t>0?a.a.get("/api/v1"+this.urlApi+t).then((function(t){e.matriz=t.data.items,e.horarios=t.data.horarios,e.gpatrones=t.data.gpatrones})).catch((function(t){var i=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):this.matriz=[]},traeOtrosDatos:function(){var t=this;a.a.get("/api/v1/empresas/combo").then((function(e){t.empresaOptions=e.data.items})).catch((function(e){var i=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},save_changes:function(){var t=this;this.$validator.validateAll().then((function(e){e&&a.a.post("/api/v1"+t.urlApi+"store",t.item).then((function(e){t.item={horario_text:null,horario_id:null,grupopatrones_id:null,grupopatrones_text:null,sucursal_id:e.data.sucursal,moviles:[]},t.errors.clear(),t.traeMatriz(e.data.sucursal),t.popupActivo=!1,t.$vs.notify({color:"success",title:"Guardar registros",text:"Los registros se han guardado exitosamente."})})).catch((function(e){var i=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))}))}},mounted:function(){this.traeOtrosDatos()},created:function(){var t=this;o.a.isRegistered||(this.$store.registerModule("itemManagement",o.a),o.a.isRegistered=!0),this.$store.dispatch("itemManagement/traerItems",this.urlApi).catch((function(e){var i=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))}},l=(i("pDuP"),i("KHd+")),c=Object(l.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"page-item-list"}},[i("vx-card",{ref:"filterCard",staticClass:"items-list-filters mb-8",attrs:{title:"Filtros",collapseAction:"",refreshContentAction:""},on:{refresh:t.resetColFilters,remove:t.resetColFilters}},[i("div",{staticClass:"vx-row"},[i("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[i("label",{staticClass:"text-sm opacity-75"},[t._v("Empresa")]),t._v(" "),i("v-select",{attrs:{options:t.empresaOptions,clearable:!1,dir:t.$vs.rtl?"rtl":"ltr"},model:{value:t.empresaFilter,callback:function(e){t.empresaFilter=e},expression:"empresaFilter"}})],1),t._v(" "),i("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[i("label",{staticClass:"text-sm opacity-75"},[t._v("Sucursales")]),t._v(" "),i("v-select",{staticClass:"mb-4 md:mb-0",attrs:{options:t.sucursalOptions,clearable:!1,dir:t.$vs.rtl?"rtl":"ltr"},model:{value:t.sucursalFilter,callback:function(e){t.sucursalFilter=e},expression:"sucursalFilter"}})],1)])]),t._v(" "),i("vx-card",{staticClass:"items-list-filters mb-8",attrs:{title:"Matriz",collapseAction:""}},[i("div",{staticClass:"vx-row"},[i("div",{staticClass:"vx-col w-full"},[i("div",{staticClass:"flex items-end px-3"},[i("feather-icon",{staticClass:"mr-2",attrs:{svgClasses:"w-6 h-6",icon:"InfoIcon"}}),t._v(" "),i("span",{staticClass:"font-medium text-lg leading-none"},[t._v("Detalle")])],1),t._v(" "),i("vs-divider")],1)]),t._v(" "),t.gpatrones.length&&t.horarios.length?i("vs-table",{attrs:{stripe:"",pagination:"","max-items":10,search:"",data:t.gpatrones},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.data;return t._l(s,(function(e,s){return i("vs-tr",{key:s},[i("vs-td",{attrs:{data:e.codigo}},[t._v("\n            "+t._s(e.codigo)+"\n          ")]),t._v(" "),t._l(t.horarios,(function(s,r){return i("vs-td",{key:r},[i("span",{staticClass:"td vs-table--td",staticStyle:{cursor:"pointer"},on:{click:function(i){t.selectedCell(s,e,t.matriz.filter((function(t){return t.horario_id==s.id&&t.grupopatrones_id==e.id})))}}},[i("vs-chip",{staticClass:"items-status",attrs:{color:t.getStatusColor(t.matriz.filter((function(t){return t.horario_id==s.id&&t.grupopatrones_id==e.id})).length)}},[t._v(t._s(t.matriz.filter((function(t){return t.horario_id==s.id&&t.grupopatrones_id==e.id})).length))])],1)])}))],2)}))}}],null,!1,3166219761)},[i("template",{slot:"header"}),t._v(" "),i("template",{slot:"thead"},[i("vs-th",[t._v("Codigos")]),t._v(" "),t._l(t.horarios,(function(e){return i("vs-th",{key:e.id},[t._v(t._s(e.horario))])}))],2)],2):t._e()],1),t._v(" "),i("vs-popup",{attrs:{title:"HORARIO: "+t.item.horario_text+" | CODIGO: "+t.item.grupopatrones_text,active:t.popupActivo},on:{"update:active":function(e){t.popupActivo=e},close:t.popupClose}},[i("vs-alert",{staticStyle:{height:"100% !important"},attrs:{active:"true",color:"primary","icon-pack":"feather",icon:"icon-info"}},[i("span",[t._v("Debe seleccionar al menos "),i("b",[t._v("1")]),t._v(" movil")])]),t._v(" "),i("br"),t._v(" "),i("div",{staticClass:"vx-row"},[i("div",{staticClass:"vx-col sm:w-1/2 w-full"},[i("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"moviles",staticClass:"w-full",attrs:{autocomplete:"",multiple:"",label:"Moviles",name:"moviles",dir:t.$vs.rtl?"rtl":"ltr",danger:!!t.errors.first("moviles"),"danger-text":t.errors.first("moviles")?t.errors.first("moviles"):""},model:{value:t.item.moviles,callback:function(e){t.$set(t.item,"moviles",e)},expression:"item.moviles"}},t._l(t.movilesOptions,(function(t){return i("vs-select-item",{key:t.id,attrs:{value:t.id,text:t.numero_movil}})})),1)],1),t._v(" "),i("div",{staticClass:"vx-col w-full"},[i("div",{staticClass:"vx-row"},[i("div",{staticClass:"vx-col w-full"},[i("div",{staticClass:"mt-3 flex flex-wrap items-center justify-end"},[i("vx-tooltip",{attrs:{color:"primary",text:"Guardar"}},[i("vs-button",{staticClass:"ml-auto mt-2",attrs:{disabled:!t.validateForm},on:{click:t.save_changes}},[t._v("Guardar")])],1),t._v(" "),i("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[i("vs-button",{staticClass:"ml-4 mt-2",attrs:{"icon-pack":"feather",icon:"icon-x"},on:{click:t.popupClose}},[t._v("Cerrar")])],1)],1)])])])])],1)],1)}),[],!1,null,null,null);e.default=c.exports},pDuP:function(t,e,i){"use strict";var s=i("vb4w");i.n(s).a},uhwG:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"#page-item-list .items-list-filters .vs__actions {\n  position: absolute;\n  top: 50%;\n}[dir] #page-item-list .items-list-filters .vs__actions {\n  -webkit-transform: translateY(-58%);\n          transform: translateY(-58%);\n}[dir=ltr] #page-item-list .items-list-filters .vs__actions {\n  right: 0;\n}[dir=rtl] #page-item-list .items-list-filters .vs__actions {\n  left: 0;\n}",""])},vb4w:function(t,e,i){var s=i("uhwG");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(s,r);s.locals&&(t.exports=s.locals)}}]);