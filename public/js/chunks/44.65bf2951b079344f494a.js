(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{0:function(e,t){},1:function(e,t){},2:function(e,t){},i4F3:function(e,t,a){"use strict";a.r(t);var s=a("qjld"),r=a("Snq/"),i=a.n(r),l=a("bJaO");a("e7F3").a.localize("en",{custom:{empresa:{required:"La empresa es requerida"},sucursal:{required:"La sucursal es requerida"},codificaciones:{min_value:"Debe cargar al menos un registro"}}});var o={components:{ImportExcel:s.a,vSelect:i.a},data:function(){return{tableData:[],header:[],sheetName:"",selected:[],item:{sucursal:null,codificaciones:[]},sucursalFilter:null,sucursalesOptions:[],empresaFilter:null,empresasOptions:[],cantCodificaciones:0}},watch:{empresaFilter:function(e){this.traeSucursales(e)}},computed:{validateForm:function(){return!this.errors.any()}},mounted:function(){this.traeOtrosDatos()},methods:{handleSelectedCodificaciones:function(e){this.cantCodificaciones=this.selected.length},loadDataInTable:function(e){var t=e.results,a=e.header,s=e.meta;this.header=a,this.tableData=t,this.sheetName=s.sheetName,this.cantCodificaciones=t.length},traeOtrosDatos:function(){var e=this;l.a.get("/api/v1/empresas/empresas").then((function(t){e.empresasOptions=t.data.items})).catch((function(t){var a=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},traeSucursales:function(e){var t=this;e>1?l.a.get("/api/v1/sucursal/combo/"+e).then((function(e){t.sucursalesOptions=e.data.items})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):(this.sucursalFilter={label:"Todos",value:"all",id:0},this.sucursalOptions=[{label:"Todos",value:"all",id:0}])},importar:function(){var e=this;this.$validator.validateAll().then((function(t){t&&(e.item.codificaciones=e.tableData,e.item.sucursal=e.sucursalFilter,e.$vs.loading(),l.a.post("/api/v1/codificaciones/codificaciones/importar",e.item).then((function(t){setTimeout((function(){e.$vs.loading.close(),e.$router.push({name:"codificaciones"}),e.$vs.notify({color:"success",title:"Codificaciones Guardadas",text:"Los registros fueron guardados exitosamente."})}),500)})).catch((function(t){var a=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})))}))},reset_data:function(){this.tableData=[],this.header=[],this.sheetName="",this.selected=[],this.cantCodificaciones=0,this.sucursalFilter=null,this.empresaFilter=null,this.errors.clear()}}},n=a("KHd+"),c=Object(n.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mb-8"},[a("import-excel",{attrs:{onSuccess:e.loadDataInTable}})],1),e._v(" "),a("vx-card",[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("div",{staticClass:"flex flex-wrap items-center"},[a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"empresas",staticClass:"w-full p-1 mr-4",attrs:{label:"Empresas",name:"empresa",dir:e.$vs.rtl?"rtl":"ltr",danger:!!e.errors.first("empresa"),"danger-text":e.errors.first("empresa")?e.errors.first("empresa"):""},model:{value:e.empresaFilter,callback:function(t){e.empresaFilter=t},expression:"empresaFilter"}},e._l(e.empresasOptions,(function(e){return a("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.razon_social}})})),1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full mr-4"},[a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"sucursal",staticClass:"w-full p-1 mr-4",attrs:{label:"Sucursales",name:"sucursal",dir:e.$vs.rtl?"rtl":"ltr",disabled:!(e.empresaFilter>1),danger:!!e.errors.first("sucursal"),"danger-text":e.errors.first("sucursal")?e.errors.first("sucursal"):""},model:{value:e.sucursalFilter,callback:function(t){e.sucursalFilter=t},expression:"sucursalFilter"}},e._l(e.sucursalesOptions,(function(e){return a("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.nombre}})})),1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-auto sm:w-auto w-full"},[a("vx-tooltip",{attrs:{color:"primary",text:"Importar"}},[a("vs-button",{staticClass:"mt-6 mr-4 mb-4 md:mb-0",attrs:{"icon-pack":"feather",icon:"icon-upload",disabled:!e.validateForm},on:{click:e.importar}},[e._v("Importar")])],1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-auto sm:w-auto w-full"},[a("vx-tooltip",{attrs:{color:"primary",text:"Limpiar"}},[a("vs-button",{staticClass:"mt-6 mr-4 mb-4 md:mb-0",attrs:{type:"border",color:"warning"},on:{click:e.reset_data}},[e._v("Limpiar")])],1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-auto sm:w-auto w-full"},[a("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[a("vs-button",{staticClass:"mt-6 mb-4 md:mb-0",attrs:{"icon-pack":"feather",icon:"icon-arrow-left",to:{name:"codificaciones"}}},[e._v("Volver")])],1)],1)])])]),e._v(" "),a("br"),e._v(" "),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"min_value:1",expression:"'min_value:1'"}],attrs:{type:"hidden",name:"codificaciones"},model:{value:e.cantCodificaciones,callback:function(t){e.cantCodificaciones=t},expression:"cantCodificaciones"}}),e._v(" "),a("span",{staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("codificaciones")))]),e._v(" "),e.tableData.length?a("vs-table",{attrs:{pagination:"","max-items":10,search:"",data:e.tableData},on:{input:e.handleSelectedCodificaciones},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.data;return e._l(s,(function(t,s){return a("vs-tr",{key:s},[a("vs-td",{attrs:{data:t.Rut}},[e._v("\n            "+e._s(t.Rut)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Rut"},model:{value:t.Rut,callback:function(a){e.$set(t,"Rut",a)},expression:"tr.Rut"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Nombre}},[e._v("\n            "+e._s(t.Nombre)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Nombre"},model:{value:t.Nombre,callback:function(a){e.$set(t,"Nombre",a)},expression:"tr.Nombre"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Apellido}},[e._v("\n            "+e._s(t.Apellido)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Apellido"},model:{value:t.Apellido,callback:function(a){e.$set(t,"Apellido",a)},expression:"tr.Apellido"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Direccion}},[e._v("\n            "+e._s(t.Direccion)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Direccion"},model:{value:t.Direccion,callback:function(a){e.$set(t,"Direccion",a)},expression:"tr.Direccion"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Comuna}},[e._v("\n            "+e._s(t.Comuna)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Comuna"},model:{value:t.Comuna,callback:function(a){e.$set(t,"Comuna",a)},expression:"tr.Comuna"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Email}},[e._v("\n            "+e._s(t.Email)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Email"},model:{value:t.Email,callback:function(a){e.$set(t,"Email",a)},expression:"tr.Email"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Telefono}},[e._v("\n            "+e._s(t.Telefono)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Telefono"},model:{value:t.Telefono,callback:function(a){e.$set(t,"Telefono",a)},expression:"tr.Telefono"}})],1)],2),e._v(" "),a("vs-td",{attrs:{data:t.Centro_costo}},[e._v("\n            "+e._s(t.Centro_costo)+"\n            "),a("template",{slot:"edit"},[a("vs-input",{staticClass:"inputx",attrs:{placeholder:"Centro Costo"},model:{value:t.Centro_costo,callback:function(a){e.$set(t,"Centro_costo",a)},expression:"tr.Centro_costo"}})],1)],2)],1)}))}}],null,!1,1336626908)},[a("template",{slot:"header"},[a("h4",[e._v(e._s(e.sheetName))])]),e._v(" "),a("template",{slot:"thead"},[a("vs-th",[e._v("Rut")]),e._v(" "),a("vs-th",[e._v("Nombre")]),e._v(" "),a("vs-th",[e._v("Apellido")]),e._v(" "),a("vs-th",[e._v("Direccion")]),e._v(" "),a("vs-th",[e._v("Comuna")]),e._v(" "),a("vs-th",[e._v("Email")]),e._v(" "),a("vs-th",[e._v("Telefono")]),e._v(" "),a("vs-th",[e._v("Centro Costo")])],1)],2):e._e()],1)],1)}),[],!1,null,null,null);t.default=c.exports},qjld:function(e,t,a){"use strict";var s=a("EUZL"),r=a.n(s),i={props:{onSuccess:{type:Function,required:!0}},data:function(){return{excelData:{header:null,results:null,meta:null}}},methods:{generateData:function(e){var t=e.header,a=e.results,s=e.meta;this.excelData.header=t,this.excelData.results=a,this.excelData.meta=s,this.onSuccess&&this.onSuccess(this.excelData)},getHeaderRow:function(e){var t,a=[],s=r.a.utils.decode_range(e["!ref"]),i=s.s.r;for(t=s.s.c;t<=s.e.c;++t){var l=e[r.a.utils.encode_cell({c:t,r:i})],o="UNKNOWN "+t;l&&l.t&&(o=r.a.utils.format_cell(l)),a.push(o)}return a},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;if(1===t.length){var a=t[0];if(!this.isExcel(a))return this.$vs.notify({title:"Login Attempt",text:"Only supports upload .xlsx, .xls, .csv suffix files",iconPack:"feather",icon:"icon-alert-circle",color:"warning"}),!1;this.uploadFile(a)}else this.$vs.notify({title:"Login Attempt",text:"Only support uploading one file!",iconPack:"feather",icon:"icon-alert-circle",color:"warning"})},readerData:function(e){var t=this;return new Promise((function(a){var s=new FileReader;s.onload=function(e){var s=e.target.result,i=r.a.read(s,{type:"array"}),l=i.SheetNames[0],o=i.Sheets[l],n=t.getHeaderRow(o),c=r.a.utils.sheet_to_json(o),u={sheetName:l};t.generateData({header:n,results:c,meta:u}),a()},s.readAsArrayBuffer(e)}))},handleClick:function(e){var t=e.target.files[0];t&&this.uploadFile(t)},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)},uploadFile:function(e){this.$refs.fileInput.value=null,this.readerData(e)}}},l=a("KHd+"),o=Object(l.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"excel-import"},[a("input",{ref:"fileInput",staticClass:"hidden",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),e._v(" "),a("div",{staticClass:"px-8 py-16 cursor-pointer text-center border-2 border-dashed d-theme-border-grey-light d-theme-dark-bg text-xl",on:{click:function(t){return e.$refs.fileInput.click()},drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[a("feather-icon",{staticClass:"block",attrs:{icon:"UploadCloudIcon",svgClasses:"h-16 w-16 stroke-current text-grey"}}),e._v(" "),a("span",[e._v("Drop Excel File or ")]),e._v(" "),a("span",{staticClass:"font-medium text-primary",on:{click:function(t){return t.stopPropagation(),e.$refs.fileInput.click()}}},[e._v("Browse")])],1)])}),[],!1,null,null,null);t.a=o.exports}}]);