(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{"6wlp":function(t,a,e){"use strict";var r=e("bJaO");function s(t){if(null==t)throw new TypeError("Cannot destructure undefined")}var i={agregarItem:function(t,a){return s(t),new Promise((function(t,e){r.a.post("/api/v1"+a.Url+"store",a.item).then((function(a){t(a)})).catch((function(t){e(t)}))}))},editarItem:function(t,a){return s(t),new Promise((function(t,e){var s="";s=a.item.id?a.Url+a.item.id:a.Url,r.a.put("/api/v1"+s,a.item).then((function(a){t(a)})).catch((function(t){e(t)}))}))},traerItems:function(t,a){var e=t.commit;return new Promise((function(t,s){r.a.get("/api/v1"+a).then((function(a){e("SET_ITEMS",a.data.items),t(a)})).catch((function(t){s(t)}))}))},traerItem:function(t,a){return s(t),new Promise((function(t,e){r.a.get("/api/v1"+a.Url+"".concat(a.Id)).then((function(a){t(a)})).catch((function(t){e(t)}))}))},borrarItem:function(t,a){var e=t.commit;return new Promise((function(t,s){r.a.delete("/api/v1"+a.Url+"".concat(a.Id)).then((function(r){e("REMOVE_RECORD",a.Id),t(r)})).catch((function(t){s(t)}))}))},borrarMasivoItem:function(t,a){var e=t.commit;return new Promise((function(t,s){r.a.post("/api/v1"+a.Url+"borrar",a.Items).then((function(r){e("REMOVE_MASSIVE_RECORD",a.Items),t(r)})).catch((function(t){s(t)}))}))}};a.a={isRegistered:!1,namespaced:!0,state:{items:[]},mutations:{SET_ITEMS:function(t,a){t.items=a},REMOVE_RECORD:function(t,a){var e=t.items.findIndex((function(t){return t.id==a}));t.items.splice(e,1)},REMOVE_MASSIVE_RECORD:function(t,a){a.forEach((function(a){var e=t.items.findIndex((function(t){return t.id==a.id}));t.items.splice(e,1)}))}},actions:i,getters:{}}},ZzzE:function(t,a,e){"use strict";e.r(a);var r=e("Snq/"),s=e.n(r),i=e("w48C"),o=e.n(i),n=(e("CVKz"),e("bJaO"));e("e7F3").a.localize("en",{custom:{horario:{required:"El horario es requerido"},habilitado:{required:"La descripcion es requerida"},sucursal:{required:"La sucursal es requerida"}}});var c={components:{vSelect:s.a,flatPickr:o.a},props:{data:{type:Object,required:!0},data_sucursales:{type:Array,required:!0}},data:function(){return{urlApi:"/horarios/horarios/",data_local:{id:this.data.id?this.data.id:null,horario:this.data.horario?this.data.horario:null,habilitado:this.data.habilitado?this.data.habilitado:null,sucursales:[]},configdateTimePicker:{enableTime:!0,enableSeconds:!0,noCalendar:!0,time_24hr:!0},empresa:this.data.empresa_id,empresasOptions:[],sucursalesOptions:[]}},watch:{empresa:function(t){this.data_local.sucursales=[],this.traeSucursales(t)}},computed:{validateForm:function(){return!this.errors.any()}},mounted:function(){var t=this;this.traeSucursales(this.data.empresa_id),this.traeOtrosDatos(),setTimeout((function(){var a=t.data_sucursales.map((function(t){return t.id}));t.data_local.sucursales=a}),500)},created:function(){},methods:{traeSucursales:function(t){var a=this;t>1?n.a.get("/api/v1/sucursal/combo/"+t).then((function(t){a.sucursalesOptions=t.data.items})).catch((function(t){var e=300==t.response.status?t.response.data.message:t;a.$vs.notify({title:"Error",text:e,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):(this.sucursalesOptions=[],this.data_local.sucursales=[])},traeOtrosDatos:function(){var t=this;n.a.get("/api/v1/empresas/listemp").then((function(a){t.empresasOptions=a.data.items})).catch((function(a){var e=300==a.response.status?a.response.data.message:a;t.$vs.notify({title:"Error",text:e,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},save_changes:function(){var t=this;this.$validator.validateAll().then((function(a){a&&t.$store.dispatch("itemManagement/editarItem",{item:t.data_local,Url:t.urlApi}).then((function(){t.$router.push({name:"horarios"}),t.showDeleteSuccess()})).catch((function(a){var e=300==a.response.status?a.response.data.message:a;t.$vs.notify({title:"Error",text:e,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))}))},showDeleteSuccess:function(){this.$vs.notify({color:"success",title:"Guardar registros",text:"Los registros se han guardado exitosamente."})},reset_data:function(){var t=this;this.data_local={id:this.data.id?this.data.id:null,horario:this.data.horario?this.data.horario:null,habilitado:this.data.habilitado?this.data.habilitado:null,sucursales:[]},this.empresa=this.data.empresa_id,this.traeSucursales(this.data.empresa_id),setTimeout((function(){var a=t.data_sucursales.map((function(t){return t.id}));t.data_local.sucursales=a}),500),this.errors.clear()}}},l=e("KHd+"),u=Object(l.a)(c,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"item-edit"}},[e("div",{staticClass:"vx-row mt-6"},[e("vs-divider",{attrs:{color:"primary"}},[e("h5",[t._v("Datos Horario")])]),t._v(" "),e("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[e("vs-select",{ref:"empresas",staticClass:"w-full",attrs:{label:"Empresas",name:"empresa",dir:t.$vs.rtl?"rtl":"ltr"},model:{value:t.empresa,callback:function(a){t.empresa=a},expression:"empresa"}},t._l(t.empresasOptions,(function(t){return e("vs-select-item",{key:t.id,attrs:{value:t.id,text:t.razon_social}})})),1)],1),t._v(" "),e("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[e("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"sucursal",staticClass:"w-full",attrs:{autocomplete:"",multiple:"",label:"Sucursales",name:"sucursal",dir:t.$vs.rtl?"rtl":"ltr",disabled:!(t.empresa>1),danger:!!t.errors.first("sucursal"),"danger-text":t.errors.first("sucursal")?t.errors.first("sucursal"):""},model:{value:t.data_local.sucursales,callback:function(a){t.$set(t.data_local,"sucursales",a)},expression:"data_local.sucursales"}},t._l(t.sucursalesOptions,(function(t){return e("vs-select-item",{key:t.id,attrs:{value:t.id,text:t.nombre}})})),1)],1),t._v(" "),e("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[e("label",{staticClass:"vs-input--label "},[t._v("Horario")]),t._v(" "),e("br"),t._v(" "),e("flat-pickr",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{config:t.configdateTimePicker,"label-placeholder":"Horario",placeholder:"Seleccione un horario",name:"horario"},model:{value:t.data_local.horario,callback:function(a){t.$set(t.data_local,"horario",a)},expression:"data_local.horario"}}),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("horario"),expression:"errors.has('horario')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("horario")))])],1),t._v(" "),e("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[e("label",{staticClass:"vs-input--label "},[t._v("Habilitado")]),t._v(" "),e("br"),t._v(" "),e("vs-switch",{staticClass:"mt-2",model:{value:t.data_local.habilitado,callback:function(a){t.$set(t.data_local,"habilitado",a)},expression:"data_local.habilitado"}})],1),t._v(" "),e("div",{staticClass:"vx-col  w-full mt-2"},[e("div",{staticClass:"vx-row"},[e("div",{staticClass:"vx-col w-full"},[e("div",{staticClass:"mt-3 flex flex-wrap items-center justify-end"},[e("vx-tooltip",{attrs:{color:"primary",text:"Guardar"}},[e("vs-button",{staticClass:"ml-auto mt-2",attrs:{disabled:!t.validateForm},on:{click:t.save_changes}},[t._v("Guardar Cambios")])],1),t._v(" "),e("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[e("vs-button",{staticClass:"ml-4 mt-2",attrs:{"icon-pack":"feather",icon:"icon-arrow-left",to:{name:"horarios"}}},[t._v("Volver")])],1),t._v(" "),e("vx-tooltip",{attrs:{color:"primary",text:"Limpiar"}},[e("vs-button",{staticClass:"ml-4 mt-2",attrs:{type:"border",color:"warning"},on:{click:t.reset_data}},[t._v("Limpiar")])],1)],1)])])])],1)])}),[],!1,null,null,null).exports,d=e("6wlp"),m={components:{itemEditSection1:u},data:function(){return{item_data:null,item_data_sucursales:null,item_not_found:!1,urlApi:"/horarios/horarios/"}},watch:{activeTab:function(){this.fetch_item_data(this.$route.params.itemId)}},methods:{fetch_item_data:function(t){var a=this;this.$store.dispatch("itemManagement/traerItem",{Id:t,Url:this.urlApi}).then((function(t){a.item_data=t.data.item[0],a.item_data_sucursales=t.data.sucursales,a.item_data.empresa_id=t.data.sucursales[0].empresa_id})).catch((function(t){404!==t.response.status?300==t.response.status?a.$vs.notify({title:"Error",text:t.response.data.message,color:"danger",iconPack:"feather",icon:"icon-alert-circle"}):a.$vs.notify({title:"Error",text:t,color:"danger",iconPack:"feather",icon:"icon-alert-circle"}):a.item_not_found=!0}))}},created:function(){d.a.isRegistered||(this.$store.registerModule("itemManagement",d.a),d.a.isRegistered=!0),this.fetch_item_data(this.$route.params.itemId)}},h=Object(l.a)(m,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"page-item-edit"}},[e("vs-alert",{attrs:{color:"danger",title:"Horario no encontrado",active:t.item_not_found},on:{"update:active":function(a){t.item_not_found=a}}},[e("span",[t._v("El horario con id: "+t._s(t.$route.params.itemId)+" no fue encontrado. ")]),t._v(" "),e("span",[e("span",[t._v("Mira  ")]),e("router-link",{staticClass:"text-inherit underline",attrs:{to:{name:"horarios"}}},[t._v("Todos los horarios")])],1)]),t._v(" "),t.item_data?e("vx-card",[e("item-edit-section1",{staticClass:"mt-4",attrs:{data:t.item_data,data_sucursales:t.item_data_sucursales}})],1):t._e()],1)}),[],!1,null,null,null);a.default=h.exports}}]);