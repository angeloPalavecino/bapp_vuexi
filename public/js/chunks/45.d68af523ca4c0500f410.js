(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"+H3F":function(e,t){e.exports="/images/usuario6.png?8dbc9de07eea7fb543566969b92f824d"},"6wlp":function(e,t,a){"use strict";var i=a("bJaO");function s(e){if(null==e)throw new TypeError("Cannot destructure undefined")}var r={agregarItem:function(e,t){return s(e),new Promise((function(e,a){i.a.post("/api/v1"+t.Url+"store",t.item).then((function(t){e(t)})).catch((function(e){a(e)}))}))},editarItem:function(e,t){return s(e),new Promise((function(e,a){var s="";s=t.item.id?t.Url+t.item.id:t.Url,i.a.put("/api/v1"+s,t.item).then((function(t){e(t)})).catch((function(e){a(e)}))}))},traerItems:function(e,t){var a=e.commit;return new Promise((function(e,s){i.a.get("/api/v1"+t).then((function(t){a("SET_ITEMS",t.data.items),e(t)})).catch((function(e){s(e)}))}))},traerItem:function(e,t){return s(e),new Promise((function(e,a){i.a.get("/api/v1"+t.Url+"".concat(t.Id)).then((function(t){e(t)})).catch((function(e){a(e)}))}))},borrarItem:function(e,t){var a=e.commit;return new Promise((function(e,s){i.a.delete("/api/v1"+t.Url+"".concat(t.Id)).then((function(i){a("REMOVE_RECORD",t.Id),e(i)})).catch((function(e){s(e)}))}))},borrarMasivoItem:function(e,t){var a=e.commit;return new Promise((function(e,s){i.a.post("/api/v1"+t.Url+"borrar",t.Items).then((function(i){a("REMOVE_MASSIVE_RECORD",t.Items),e(i)})).catch((function(e){s(e)}))}))}};t.a={isRegistered:!1,namespaced:!0,state:{items:[]},mutations:{SET_ITEMS:function(e,t){e.items=t},REMOVE_RECORD:function(e,t){var a=e.items.findIndex((function(e){return e.id==t}));e.items.splice(a,1)},REMOVE_MASSIVE_RECORD:function(e,t){t.forEach((function(t){var a=e.items.findIndex((function(e){return e.id==t.id}));e.items.splice(a,1)}))}},actions:r,getters:{}}},"8QA8":function(e,t,a){"use strict";a.r(t);var i=a("Snq/"),s=a.n(i),r=a("bJaO");a("e7F3").a.localize("en",{custom:{nombre:{required:"El nombre es requerido"},apellido:{required:"El apellido es requerido"},comuna:{required:"La comuna es requerida"},email:{required:"El email es requerido",email:"El email debe ser valido"},telefono:{required:"El telefono es requerido"},centro_costo:{required:"El centro de costo es requerido"},codigo:{required:"El codigo es requerido"},rut:{required:"El rut es requerida"},direccion:{required:"La direccion es requerida"},sucursal:{required:"La sucursal es requerida"}}});var o={components:{vSelect:s.a},props:{},data:function(){return{urlApi:"/codificaciones/codificaciones/",data_local:{codigo:null},empresa:1,center:{lat:-33.4533624,lng:-70.6642131},zoom:11,map:null,marker:null,markersPat:[],boundsMarker:null,boundsSucursal:null,autocomplete:null,gpatronesOptions:[],empresasOptions:[],sucursalesOptions:[],patrones:[],tipObj:null,offset:{x:10,y:10}}},watch:{empresa:function(e){(this.clearOverlaysPat(),this.data_local.sucursal_id=null,null!=this.markerSuc)&&(this.markerSuc.setMap(null),this.markerSuc=null);this.traeSucursales(e)},sucursal:function(e){(this.traeCodigos(e),this.data_local.codigo=null,this.clearOverlaysPat(),null!=this.markerSuc)&&(this.markerSuc.setMap(null),this.markerSuc=null);this.cargaSucursal(e)},codigo:function(e){var t=this;this.patrones=[],this.traePatrones(e),setTimeout((function(){t.patrones.length>0&&t.cargaPatrones(t.patrones)}),500)}},computed:{validateForm:function(){return!this.errors.any()},sucursal:function(){return this.data_local.sucursal_id},codigo:function(){return this.data_local.codigo}},mounted:function(){this.traeOtrosDatos(),this.autocomplete=new google.maps.places.Autocomplete(this.$refs.autocomplete,{types:["geocode"]}),this.autocomplete.addListener("place_changed",this.asignaDireccion);var e=this.center,t=this.zoom,a=new google.maps.Map(document.getElementById("map"),{zoom:t,center:e});this.map=a},methods:{asignaDireccion:function(){this.data_local.direccion=this.autocomplete.getPlace().formatted_address,this.data_local.lat=this.autocomplete.getPlace().geometry.location.lat().toFixed(5),this.data_local.lng=this.autocomplete.getPlace().geometry.location.lng().toFixed(5),this.agregarMarker()},agregarMarker:function(){var e=this;if(this.data_local.lat&&this.data_local.lng){var t=parseFloat(this.data_local.lat),i=parseFloat(this.data_local.lng),s=this.data_local.direccion,r=this.map;if(null!=this.marker)this.marker.setMap(null),this.marker=null;var o=new google.maps.LatLngBounds;o.extend(new google.maps.LatLng(t.toFixed(5),i.toFixed(5))),e.boundsMarker=o,null!==this.boundsSucursal&&(o=this.boundsSucursal).extend(new google.maps.LatLng(t.toFixed(5),i.toFixed(5)));var l=new google.maps.Marker({position:{lat:t,lng:i},infoText:s,title:s,draggable:!0,animation:google.maps.Animation.DROP,icon:{url:a("+H3F")}});l.setMap(r),google.maps.event.addListener(l,"dragend",(function(){e.geocodePosition(l.getPosition())}));new google.maps.LatLng(t,i);e.map.fitBounds(o),this.marker=l}else this.$vs.notify({title:"Error",text:"Debe ingresar una direccion",color:"danger",iconPack:"feather",icon:"icon-alert-circle"})},geocodePosition:function(e){var t=this;(new google.maps.Geocoder).geocode({latLng:e},(function(a,i){i==google.maps.GeocoderStatus.OK?(t.data_local.direccion=a[0].formatted_address,t.data_local.lat=a[0].geometry.location.lat().toFixed(5),t.data_local.lng=a[0].geometry.location.lng().toFixed(5),t.map.setCenter(e)):this.$vs.notify({title:"Error",text:"No se puede determinar la direccion. "+i,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},traePatrones:function(e){var t=this;e>1&&r.a.get("/api/v1/patrones/grupos/"+e).then((function(e){t.patrones=e.data.patrones})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},traeSucursales:function(e){var t=this;e>1?r.a.get("/api/v1/sucursal/combo/"+e).then((function(e){t.sucursalesOptions=e.data.items})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})})):(this.sucursalesOptions=[],this.gpatronesOptions=[],this.patrones=[],this.data_local.codigo=null,this.data_local.sucursal_id=null)},traeCodigos:function(e){var t=this;r.a.get("/api/v1/patrones/grupos/codigos/"+e).then((function(e){t.gpatronesOptions=e.data.items})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},traeOtrosDatos:function(){var e=this;r.a.get("/api/v1/empresas/listemp").then((function(t){e.empresasOptions=t.data.items})).catch((function(t){var a=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},cargaSucursal:function(e){if(e>0){var t=this.sucursalesOptions.find((function(t){return t.id===e})),i=parseFloat(t.lat),s=parseFloat(t.lng),r=t.nombre,o=new google.maps.LatLngBounds;o.extend(new google.maps.LatLng(i.toFixed(5),s.toFixed(5))),this.boundsSucursal=o,null!==this.boundsMarker&&(o=this.boundsMarker).extend(new google.maps.LatLng(i.toFixed(5),s.toFixed(5)));var l=new google.maps.Marker({position:{lat:i,lng:s},infoText:r,title:r,draggable:!1,animation:google.maps.Animation.DROP,icon:{url:a("Ymv7")}});l.setMap(this.map),this.markerSuc=l,this.map.fitBounds(o)}},cargaPatrones:function(e){var t,a=this;e.forEach((function(e,i){for(var s=e.lat,r=e.lng,o=e.color,l=e.id,n=e.descripcion,c=s.split(","),d=r.split(","),u=[],m=0;m<c.length;m++){var p=parseFloat(c[m]),v=parseFloat(d[m]);u[m]=new google.maps.LatLng(p.toFixed(5),v.toFixed(5))}t=new google.maps.Polygon({paths:u,fillColor:o,fillOpacity:.1,strokeWeight:.8,id:l,name:n,map:a.map}),google.maps.event.addListener(t,"mouseover",(function(e){a.injectTooltip(e,this.name)})),google.maps.event.addListener(t,"mousemove",(function(e){a.moveTooltip(e)})),google.maps.event.addListener(t,"mouseout",(function(e){a.deleteTooltip(e)})),a.markersPat.push(t)}))},clearOverlaysPat:function(){this.markersPat.length>0&&this.markersPat.forEach((function(e,t){e.setMap(null)})),this.markersPat=[]},deleteTooltip:function(e){this.tipObj&&(document.body.removeChild(this.tipObj),this.tipObj=null)},moveTooltip:function(e){this.tipObj&&e&&(this.tipObj.style.top=e.ya.clientY+this.offset.y+"px",this.tipObj.style.left=e.ya.clientX+this.offset.x+"px")},injectTooltip:function(e,t){!this.tipObj&&e&&(this.tipObj=document.createElement("div"),this.tipObj.style.width="100px",this.tipObj.style.height="40px",this.tipObj.style.background="white",this.tipObj.style.borderRadius="5px",this.tipObj.style.padding="10px",this.tipObj.style.fontFamily="Arial,Helvetica",this.tipObj.style.textAlign="center",this.tipObj.style.zIndex="99999",this.tipObj.innerHTML=t,this.tipObj.style.position="fixed",this.tipObj.style.top=e.ya.clientY+this.offset.y+"px",this.tipObj.style.left=e.ya.clientX+this.offset.x+"px",document.body.appendChild(this.tipObj))},save_changes:function(){var e=this;this.$validator.validateAll().then((function(t){t&&e.$store.dispatch("itemManagement/agregarItem",{item:e.data_local,Url:e.urlApi}).then((function(){e.$router.push({name:"codificaciones"}),e.showDeleteSuccess()})).catch((function(t){var a=300==t.response.status?t.response.data.message:t;e.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))}))},showDeleteSuccess:function(){this.$vs.notify({color:"success",title:"Guardar registros",text:"Los registros se han guardado exitosamente."})},reset_data:function(){(this.data_local={codigo:null},this.sucursalesOptions=[],this.gpatronesOptions=[],this.patrones=[],this.empresa=1,this.map&&(this.map.setZoom(this.zoom),this.map.setCenter(this.center)),null!=this.marker)&&(this.marker.setMap(null),this.marker=null);null!=this.markerSuc&&(this.markerSuc.setMap(null),this.markerSuc=null);this.clearOverlaysPat(),this.errors.clear()}}},l=a("KHd+"),n=Object(l.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"item-add"}},[a("div",{staticClass:"vx-row mt-6"},[a("vs-divider",{attrs:{color:"primary"}},[a("h5",[e._v("Datos codificacion")])]),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Nombre",name:"nombre",danger:!!e.errors.first("nombre"),"danger-text":e.errors.first("nombre")?e.errors.first("nombre"):"","val-icon-danger":"clear"},model:{value:e.data_local.nombre,callback:function(t){e.$set(e.data_local,"nombre",t)},expression:"data_local.nombre"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Apellido",name:"apellido",danger:!!e.errors.first("apellido"),"danger-text":e.errors.first("apellido")?e.errors.first("apellido"):"","val-icon-danger":"clear"},model:{value:e.data_local.apellido,callback:function(t){e.$set(e.data_local,"apellido",t)},expression:"data_local.apellido"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Rut",name:"rut",danger:!!e.errors.first("rut"),"danger-text":e.errors.first("rut")?e.errors.first("rut"):"","val-icon-danger":"clear"},model:{value:e.data_local.rut,callback:function(t){e.$set(e.data_local,"rut",t)},expression:"data_local.rut"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"email|required",expression:"'email|required'"}],staticClass:"w-full p-1",attrs:{type:"email","label-placeholder":"Email",name:"email",danger:!!e.errors.first("email"),"danger-text":e.errors.first("email")?e.errors.first("email"):"","val-icon-danger":"clear"},model:{value:e.data_local.email,callback:function(t){e.$set(e.data_local,"email",t)},expression:"data_local.email"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Telefono",name:"telefono",danger:!!e.errors.first("telefono"),"danger-text":e.errors.first("telefono")?e.errors.first("telefono"):"","val-icon-danger":"clear"},model:{value:e.data_local.telefono,callback:function(t){e.$set(e.data_local,"telefono",t)},expression:"data_local.telefono"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Centro Costo",name:"centro_costo",danger:!!e.errors.first("centro_costo"),"danger-text":e.errors.first("centro_costo")?e.errors.first("centro_costo"):"","val-icon-danger":"clear"},model:{value:e.data_local.centro_costo,callback:function(t){e.$set(e.data_local,"centro_costo",t)},expression:"data_local.centro_costo"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-select",{ref:"empresas",staticClass:"w-full p-1",attrs:{label:"Empresas",name:"empresa",dir:e.$vs.rtl?"rtl":"ltr"},model:{value:e.empresa,callback:function(t){e.empresa=t},expression:"empresa"}},e._l(e.empresasOptions,(function(e){return a("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.razon_social}})})),1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"sucursal",staticClass:"w-full p-1",attrs:{label:"Sucursales",name:"sucursal",dir:e.$vs.rtl?"rtl":"ltr",disabled:!(e.empresa>1),danger:!!e.errors.first("sucursal"),"danger-text":e.errors.first("sucursal")?e.errors.first("sucursal"):""},model:{value:e.data_local.sucursal_id,callback:function(t){e.$set(e.data_local,"sucursal_id",t)},expression:"data_local.sucursal_id"}},e._l(e.sucursalesOptions,(function(e){return a("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.nombre}})})),1)],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"hidden",name:"direccion"},model:{value:e.data_local.direccion,callback:function(t){e.$set(e.data_local,"direccion",t)},expression:"data_local.direccion"}}),e._v(" "),a("div",{staticClass:"vs-component vs-con-input-label vs-input mt-6 w-full vs-input-primary is-label-placeholder"},[a("div",{staticClass:"vs-con-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.data_local.direccion,expression:"data_local.direccion"}],ref:"autocomplete",class:e.data_local.direccion?"vs-inputx vs-input--input normal hasValue":"vs-inputx vs-input--input normal",style:e.errors.first("direccion")?"border: 1px solid rgba(var(--vs-danger),1)!important;":"border: 1px solid rgba(0, 0, 0, 0.2);",attrs:{type:"text",required:"",name:"direccion",placeholder:""},domProps:{value:e.data_local.direccion},on:{input:function(t){t.target.composing||e.$set(e.data_local,"direccion",t.target.value)}}}),e._v(" "),a("span",{staticClass:"input-span-placeholder vs-input--placeholder normal normal vs-placeholder-label"},[e._v("\n      Direccion\n    ")]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("direccion"),expression:"errors.has('direccion')"}],staticClass:"input-icon-validate vs-input--icon-validate",staticStyle:{background:"rgba(var(--vs-danger),.2)"}},[a("i",{staticClass:"vs-icon notranslate icon-scale material-icons null",staticStyle:{color:"rgba(var(--vs-danger),1)"},attrs:{valiconpack:"material-icons"}},[e._v("clear")])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("direccion"),expression:"errors.has('direccion')"}],staticClass:"con-text-validation span-text-validation-danger \n              vs-input--text-validation-span v-enter-to",staticStyle:{height:"20px"}},[a("span",{staticClass:"span-text-validation"},[e._v("\n                    "+e._s(e.errors.first("direccion"))+"\n                    ")])])])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Comuna",name:"comuna",danger:!!e.errors.first("comuna"),"danger-text":e.errors.first("comuna")?e.errors.first("comuna"):"","val-icon-danger":"clear"},model:{value:e.data_local.comuna,callback:function(t){e.$set(e.data_local,"comuna",t)},expression:"data_local.comuna"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full mt-2"},[a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"codigo",staticClass:"w-full p-1",attrs:{label:"Codigo",name:"codigo",dir:e.$vs.rtl?"rtl":"ltr",disabled:!(e.data_local.sucursal_id>0),danger:!!e.errors.first("codigo"),"danger-text":e.errors.first("codigo")?e.errors.first("codigo"):""},model:{value:e.data_local.codigo,callback:function(t){e.$set(e.data_local,"codigo",t)},expression:"data_local.codigo"}},e._l(e.gpatronesOptions,(function(e){return a("vs-select-item",{key:e.id,attrs:{value:e.id,text:e.codigo}})})),1)],1),e._v(" "),a("div",{staticClass:"vx-col w-full mt-2"},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("div",{staticClass:"mt-3 flex flex-wrap items-center justify-end"},[a("vx-tooltip",{attrs:{color:"primary",text:"Guardar"}},[a("vs-button",{staticClass:"ml-auto mt-2",attrs:{disabled:!e.validateForm},on:{click:e.save_changes}},[e._v("Guardar Cambios")])],1),e._v(" "),a("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[a("vs-button",{staticClass:"ml-4 mt-2",attrs:{"icon-pack":"feather",icon:"icon-arrow-left",to:{name:"codificaciones"}}},[e._v("Volver")])],1),e._v(" "),a("vx-tooltip",{attrs:{color:"primary",text:"Limpiar"}},[a("vs-button",{staticClass:"ml-4 mt-2",attrs:{type:"border",color:"warning"},on:{click:e.reset_data}},[e._v("Limpiar")])],1)],1)])])])],1),e._v(" "),a("vx-card",{staticClass:"mb-base mt-4",attrs:{title:"Mapa",collapseAction:""}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("div",{staticClass:"flex flex-wrap items-center"},[a("div",{staticClass:"flex-grow mt-6"},[a("feather-icon",{staticClass:"mr-2 mt-2",attrs:{svgClasses:"w-6 h-6",icon:"MapIcon"}}),e._v(" "),a("span",{staticClass:"font-medium text-lg leading-none"},[e._v("Detalle")])],1),e._v(" "),a("vs-divider")],1)])]),e._v(" "),a("div",{staticClass:"block overflow-x-auto"},[a("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"map"}})])])],1)}),[],!1,null,null,null).exports,c=a("6wlp"),d={components:{itemAddSection1:n},data:function(){return{urlApi:"/codificaciones/codificaciones/"}},watch:{},methods:{},created:function(){c.a.isRegistered||(this.$store.registerModule("itemManagement",c.a),c.a.isRegistered=!0)}},u=Object(l.a)(d,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"page-item-add"}},[t("vx-card",[t("item-add-section1",{staticClass:"mt-4"})],1)],1)}),[],!1,null,null,null);t.default=u.exports},Ymv7:function(e,t){e.exports="/images/sucursal7.png?b150aec62809e814bc49429efb22a978"}}]);