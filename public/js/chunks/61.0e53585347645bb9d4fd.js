(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{"6wlp":function(t,e,a){"use strict";var i=a("bJaO");function o(t){if(null==t)throw new TypeError("Cannot destructure undefined")}var s={agregarItem:function(t,e){return o(t),new Promise((function(t,a){i.a.post("/api/v1"+e.Url+"store",e.item).then((function(e){t(e)})).catch((function(t){a(t)}))}))},editarItem:function(t,e){return o(t),new Promise((function(t,a){var o="";o=e.item.id?e.Url+e.item.id:e.Url,i.a.put("/api/v1"+o,e.item).then((function(e){t(e)})).catch((function(t){a(t)}))}))},traerItems:function(t,e){var a=t.commit;return new Promise((function(t,o){i.a.get("/api/v1"+e).then((function(e){a("SET_ITEMS",e.data.items),t(e)})).catch((function(t){o(t)}))}))},traerItem:function(t,e){return o(t),new Promise((function(t,a){i.a.get("/api/v1"+e.Url+"".concat(e.Id)).then((function(e){t(e)})).catch((function(t){a(t)}))}))},borrarItem:function(t,e){var a=t.commit;return new Promise((function(t,o){i.a.delete("/api/v1"+e.Url+"".concat(e.Id)).then((function(i){a("REMOVE_RECORD",e.Id),t(i)})).catch((function(t){o(t)}))}))},borrarMasivoItem:function(t,e){var a=t.commit;return new Promise((function(t,o){i.a.post("/api/v1"+e.Url+"borrar",e.Items).then((function(i){a("REMOVE_MASSIVE_RECORD",e.Items),t(i)})).catch((function(t){o(t)}))}))}};e.a={isRegistered:!1,namespaced:!0,state:{items:[]},mutations:{SET_ITEMS:function(t,e){t.items=e},REMOVE_RECORD:function(t,e){var a=t.items.findIndex((function(t){return t.id==e}));t.items.splice(a,1)},REMOVE_MASSIVE_RECORD:function(t,e){e.forEach((function(e){var a=t.items.findIndex((function(t){return t.id==e.id}));t.items.splice(a,1)}))}},actions:s,getters:{}}},bcZM:function(t,e,a){"use strict";a.r(e);var i=a("Snq/"),o=a.n(i),s=a("bJaO");a("e7F3").a.localize("en",{custom:{codigo:{required:"El codigo es requerido"},color:{required:"El color es requerido"},descripcion:{required:"La descripcion es requerida"},lat:{required:"El patron es requerido"},lng:{required:"El patron es requerido"}}});var n={components:{vSelect:o.a},props:{},data:function(){return{urlApi:"/patrones/patrones/",data_local:{lat:"",lng:"",color:"#ffff00"},center:{lat:-33.4533624,lng:-70.6642131},zoom:11,map:null,marker:null,element:null,markersPat:[],patronesOptions:[],selectPatrones:[],tipObj:null,offset:{x:10,y:10}}},computed:{validateForm:function(){return!this.errors.any()}},mounted:function(){this.traeOtrosDatos();var t=this.center,e=this.zoom,a="",i="",o=new google.maps.Map(document.getElementById("map"),{zoom:e,center:t});this.map=o;var s=this,n=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.POLYGON]},polygonOptions:{fillColor:"#ffff00",fillOpacity:.1,strokeWeight:.8,clickable:!1,zIndex:1,editable:!0}});n.setMap(s.map),google.maps.event.addListener(n,"overlaycomplete",(function(t){if(s.element&&(s.element.setMap(null),s.data_local.lat="",s.data_local.lng=""),n.setDrawingMode(null),s.element=t.overlay,t.type==google.maps.drawing.OverlayType.POLYGON){a="",i="";for(var e=0;e<s.element.getPath().getLength();e++)a+=s.element.getPath().getAt(e).lat().toFixed(5)+",",i+=s.element.getPath().getAt(e).lng().toFixed(5)+",";s.data_local.lat=a.substring(0,a.length-1),s.data_local.lng=i.substring(0,i.length-1),google.maps.event.addListener(s.element,"click",(function(t){s.element.getPath().removeAt(t.vertex),a="",i="";for(var e=0;e<s.element.getPath().getLength();e++)a+=s.element.getPath().getAt(e).lat().toFixed(5)+",",i+=s.element.getPath().getAt(e).lng().toFixed(5)+",";s.data_local.lat=a.substring(0,a.length-1),s.data_local.lng=i.substring(0,i.length-1)})),google.maps.event.addListener(s.element.getPath(),"set_at",(function(){a="",i="";for(var t=0;t<s.element.getPath().getLength();t++)a+=s.element.getPath().getAt(t).lat().toFixed(5)+",",i+=s.element.getPath().getAt(t).lng().toFixed(5)+",";s.data_local.lat=a.substring(0,a.length-1),s.data_local.lng=i.substring(0,i.length-1)})),google.maps.event.addListener(s.element.getPath(),"insert_at",(function(){a="",i="";for(var t=0;t<s.element.getPath().getLength();t++)a+=s.element.getPath().getAt(t).lat().toFixed(5)+",",i+=s.element.getPath().getAt(t).lng().toFixed(5)+",";s.data_local.lat=a.substring(0,a.length-1),s.data_local.lng=i.substring(0,i.length-1)}))}})),google.maps.event.addListener(n,"drawingmode_changed",(function(){n.getDrawingMode()==google.maps.drawing.OverlayType.POLYGON&&null!=s.element&&s.element.setMap(null),s.data_local.lat="",s.data_local.lng=""}))},methods:{setSelected:function(t){this.clearOverlaysPat(),this.cargaPatrones(this.selectPatrones)},traeOtrosDatos:function(){var t=this;s.a.get("/api/v1/patrones/patrones").then((function(e){t.patronesOptions=e.data.items})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))},cargaPatrones:function(t){var e,a=this,i=this;t.forEach((function(t,o){for(var s=a.patronesOptions.find((function(e){return e.id===t})),n=s.lat,r=s.lng,l=s.color,c=s.id,d=s.descripcion,u=n.split(","),p=r.split(","),m=[],v=0;v<u.length;v++){var g=parseFloat(u[v]),f=parseFloat(p[v]);m[v]=new google.maps.LatLng(g.toFixed(5),f.toFixed(5))}e=new google.maps.Polygon({paths:m,fillColor:l,fillOpacity:.1,strokeWeight:.8,id:c,name:d,map:i.map}),google.maps.event.addListener(e,"mouseover",(function(t){i.injectTooltip(t,this.name)})),google.maps.event.addListener(e,"mousemove",(function(t){i.moveTooltip(t)})),google.maps.event.addListener(e,"mouseout",(function(t){i.deleteTooltip(t)})),i.markersPat.push(e)}))},clearOverlaysPat:function(){this.markersPat.length>0&&this.markersPat.forEach((function(t,e){t.setMap(null)})),this.markersPat=[]},deleteTooltip:function(t){this.tipObj&&(document.body.removeChild(this.tipObj),this.tipObj=null)},moveTooltip:function(t){this.tipObj&&t&&(this.tipObj.style.top=t.ya.clientY+this.offset.y+"px",this.tipObj.style.left=t.ya.clientX+this.offset.x+"px")},injectTooltip:function(t,e){!this.tipObj&&t&&(this.tipObj=document.createElement("div"),this.tipObj.style.width="100px",this.tipObj.style.height="40px",this.tipObj.style.background="white",this.tipObj.style.borderRadius="5px",this.tipObj.style.padding="10px",this.tipObj.style.fontFamily="Arial,Helvetica",this.tipObj.style.textAlign="center",this.tipObj.style.zIndex="99999",this.tipObj.innerHTML=e,this.tipObj.style.position="fixed",this.tipObj.style.top=t.ya.clientY+this.offset.y+"px",this.tipObj.style.left=t.ya.clientX+this.offset.x+"px",document.body.appendChild(this.tipObj))},save_changes:function(){var t=this;this.$validator.validateAll().then((function(e){e&&t.$store.dispatch("itemManagement/agregarItem",{item:t.data_local,Url:t.urlApi}).then((function(){t.$router.push({name:"patrones"}),t.showDeleteSuccess()})).catch((function(e){var a=300==e.response.status?e.response.data.message:e;t.$vs.notify({title:"Error",text:a,color:"danger",iconPack:"feather",icon:"icon-alert-circle"})}))}))},showDeleteSuccess:function(){this.$vs.notify({color:"success",title:"Guardar registros",text:"Los registros se han guardado exitosamente."})},reset_data:function(){this.data_local={lat:"",lng:"",color:"#ffff00"},this.element&&(this.element.setMap(null),this.errors.clear()),this.map&&(this.map.setZoom(this.zoom),this.map.setCenter(this.center)),this.clearOverlaysPat(),this.selectPatrones=[],this.errors.clear()}}},r=a("KHd+"),l=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"item-add"}},[a("div",{staticClass:"vx-row mt-6"},[a("vs-divider",{attrs:{color:"primary"}},[a("h5",[t._v("Datos Patron")])]),t._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Codigo",name:"codigo",danger:!!t.errors.first("codigo"),"danger-text":t.errors.first("codigo")?t.errors.first("codigo"):"","val-icon-danger":"clear"},model:{value:t.data_local.codigo,callback:function(e){t.$set(t.data_local,"codigo",e)},expression:"data_local.codigo"}})],1),t._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full mt-2"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full p-1",attrs:{"label-placeholder":"Descripcion",name:"descripcion",danger:!!t.errors.first("descripcion"),"danger-text":t.errors.first("descripcion")?t.errors.first("descripcion"):"","val-icon-danger":"clear"},model:{value:t.data_local.descripcion,callback:function(e){t.$set(t.data_local,"descripcion",e)},expression:"data_local.descripcion"}})],1),t._v(" "),a("div",{staticClass:"vx-col md:w-auto w-full mt-4"},[a("span",{staticClass:" text-sm"},[t._v("Color ")]),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.data_local.color,expression:"data_local.color"}],staticClass:"w-full",attrs:{name:"color",type:"color",danger:!!t.errors.first("color"),"val-icon-danger":"clear"},domProps:{value:t.data_local.color},on:{input:function(e){e.target.composing||t.$set(t.data_local,"color",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("color"),expression:"errors.has('color')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("color")))])]),t._v(" "),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"hidden",name:"lat"},model:{value:t.data_local.lat,callback:function(e){t.$set(t.data_local,"lat",e)},expression:"data_local.lat"}}),t._v(" "),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{type:"hidden",name:"lng"},model:{value:t.data_local.lng,callback:function(e){t.$set(t.data_local,"lng",e)},expression:"data_local.lng"}}),t._v(" "),a("div",{staticClass:"vx-col w-full mt-2"},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("div",{staticClass:"mt-3 flex flex-wrap items-center justify-end"},[a("vx-tooltip",{attrs:{color:"primary",text:"Guardar"}},[a("vs-button",{staticClass:"ml-auto mt-2",attrs:{disabled:!t.validateForm},on:{click:t.save_changes}},[t._v("Guardar Cambios")])],1),t._v(" "),a("vx-tooltip",{attrs:{color:"primary",text:"Volver"}},[a("vs-button",{staticClass:"ml-4 mt-2",attrs:{"icon-pack":"feather",icon:"icon-arrow-left",to:{name:"patrones"}}},[t._v("Volver")])],1),t._v(" "),a("vx-tooltip",{attrs:{color:"primary",text:"Limpiar"}},[a("vs-button",{staticClass:"ml-4 mt-2",attrs:{type:"border",color:"warning"},on:{click:t.reset_data}},[t._v("Limpiar")])],1)],1)])])])],1),t._v(" "),a("vx-card",{staticClass:"mb-base mt-4",attrs:{title:"Mapa",collapseAction:""}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("div",{staticClass:"flex flex-wrap items-center"},[a("div",{staticClass:"flex-grow mt-6"},[a("feather-icon",{staticClass:"mr-2 mt-2",attrs:{svgClasses:"w-6 h-6",icon:"MapIcon"}}),t._v(" "),a("span",{staticClass:"font-medium text-lg leading-none"},[t._v("Detalle")])],1),t._v(" "),a("vs-select",{ref:"patrones",attrs:{multiple:"",autocomplete:"",label:"Patrones",name:"patrones",dir:t.$vs.rtl?"rtl":"ltr"},on:{input:t.setSelected},model:{value:t.selectPatrones,callback:function(e){t.selectPatrones=e},expression:"selectPatrones"}},t._l(t.patronesOptions,(function(t){return a("vs-select-item",{key:t.id,attrs:{value:t.id,text:t.codigo}})})),1),t._v(" "),a("vs-divider")],1)])]),t._v(" "),a("div",{staticClass:"block overflow-x-auto"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("lat")||t.errors.has("lng"),expression:"errors.has('lat') || errors.has('lng')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("lat")))]),t._v(" "),a("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"map"}})])])],1)}),[],!1,null,null,null).exports,c=a("6wlp"),d={components:{itemAddSection1:l},data:function(){return{urlApi:"/patrones/patrones/"}},watch:{},methods:{},created:function(){c.a.isRegistered||(this.$store.registerModule("itemManagement",c.a),c.a.isRegistered=!0)}},u=Object(r.a)(d,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"page-item-add"}},[e("vx-card",[e("item-add-section1",{staticClass:"mt-4"})],1)],1)}),[],!1,null,null,null);e.default=u.exports}}]);